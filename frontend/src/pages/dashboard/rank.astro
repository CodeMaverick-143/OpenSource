---
import AppLayout from "../../components/layout/AppLayout.astro";
import { getRank } from "../../lib/api";
import RankDisplay from "../../components/dashboard/RankDisplay.astro";
import ErrorMessage from "../../components/ui/ErrorMessage.astro";

let rankInfo = null;
let error = null;

try {
    rankInfo = await getRank();
} catch (e) {
    error = e instanceof Error ? e.message : "Failed to load rank information";
}
---

<AppLayout title="Rank & Progress - ContriVerse">
    <div class="min-h-screen bg-gray-50">
        <div class="container-dashboard py-8">
            <div class="mb-6">
                <h1 class="text-3xl font-bold text-gray-900">
                    Rank & Progress
                </h1>
                <p class="text-gray-600 mt-2">
                    Track your position on the leaderboard
                </p>
            </div>

            {
                error ? (
                    <ErrorMessage
                        title="Error Loading Rank"
                        description={error}
                    />
                ) : (
                    <RankDisplay rankInfo={rankInfo} />
                )
            }
        </div>
    </div>
</AppLayout>
